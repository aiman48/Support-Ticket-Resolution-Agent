# Support Ticket Resolution Agent with Multi-Step Review Loop (LangGraph + RAG)

---

## üß† Project Summary

This is a support ticket resolution agent that:

* Takes **live user input** for support issues
* Uses **LangGraph** to define a multi-step process:

  * Classify the issue
  * Retrieve relevant documents
  * Draft a support reply
  * Auto-review the reply (loop if rejected)
  * Escalate if necessary
* Integrates **RAG (Retrieval-Augmented Generation)** to ground replies using support documents.

---

## ‚úÖ Features Checklist

| Feature                              | Status |
| ------------------------------------ | ------ |
| Live user input                      | ‚úÖ      |
| LangGraph multi-step state machine   | ‚úÖ      |
| Issue classification (Billing, etc.) | ‚úÖ      |
| Retrieval-Augmented Generation (RAG) | ‚úÖ      |
| Short, helpful support reply         | ‚úÖ      |
| LLM-based review with retry loop     | ‚úÖ      |
| Escalation logged to CSV             | ‚úÖ      |
| Clean and readable final output      | ‚úÖ      |

---

## üèóÔ∏è Project Structure

```
STRA/
‚îú‚îÄ‚îÄ main.py                  # Main pipeline
‚îú‚îÄ‚îÄ data/                    # Support policy documents
‚îÇ   ‚îú‚îÄ‚îÄ billing_docs.txt
‚îÇ   ‚îú‚îÄ‚îÄ technical_docs.txt
‚îÇ   ‚îú‚îÄ‚îÄ general_docs.txt
‚îÇ   ‚îî‚îÄ‚îÄ security_docs.txt
‚îú‚îÄ‚îÄ escalation_log.csv      # Escalation record log (auto-created)
‚îú‚îÄ‚îÄ .env                    # Contains GROQ_API_KEY
‚îî‚îÄ‚îÄ README.md              
```

---

## ‚öôÔ∏è Setup Instructions

### 1. Install dependencies:

```bash
pip install -r requirements.txt
```

Use this if you don‚Äôt have a `requirements.txt`:

```bash
pip install langgraph langchain langchain-community langchain-core langchain-huggingface langchain-groq faiss-cpu python-dotenv
```

### 2. Create `.env` file:

```
GROQ_API_KEY=your_groq_api_key_here
```

### 3. Add your support documents

Put text files inside the `/data` folder:

* `billing_docs.txt`
* `technical_docs.txt`
* `general_docs.txt`
* `security_docs.txt`

Each file should contain bullet points with issues, policies, keywords, and troubleshooting steps.

---

## üöÄ How to Run

```bash
python main.py
```

You will be prompted for:

```
Subject: Refund failed
Description: I cancelled my subscription but got charged again.
```

The system will:

1. Classify the issue
2. Retrieve relevant policies from your docs
3. Draft a short helpful reply
4. Review it
5. Retry/rewrite if rejected
6. Escalate if needed

---

## üîÅ Example Prompts (Test Cases)

### Test 1: Billing

```
Subject: Refund failed
Description: I cancelled my subscription but got charged again.
```

### Test 2: Technical

```
Subject: App crashes
Description: Every time I open the mobile app it crashes on the login screen.
```

### Test 3: Security

```
Subject: Someone accessed my account
Description: I received an alert that someone logged into my account from an unknown location.
```

### Test 4: General

```
Subject: How to change profile picture?
Description: I'm trying to update my display picture but can't find the option.
```

---

## üìΩÔ∏è Video Demo Script

### Step-by-step (Narration & Actions)

1. **Intro (Narrate):**

> "Hi, this is a demo of my Support Ticket Resolution Agent built using LangGraph, Groq, and RAG."

2. **Show `main.py` in VS Code:**

> "The system uses a graph-based pipeline with multiple steps. Each node is defined as a function and added to the LangGraph."

3. **Run the code:**

```bash
python main.py
```

> Narrate: "Now I‚Äôll enter a support ticket live."

4. **Enter Input:**

```
Subject: Refund failed
Description: I cancelled my subscription but got charged again.
```

> "The model will classify this issue, retrieve helpful policies, draft a support reply, and auto-review the message."

5. **Show Output:**

> "Here‚Äôs the reply generated by the model. It‚Äôs clear, polite, and helpful. If rejected, the model tries again automatically."

6. **Open `escalation_log.csv` if triggered:**

> "Escalated tickets get logged here."

7. **Summary (Narrate):**

> "This system reduces human effort in support teams by auto-resolving common issues using LLMs and document retrieval."

---

## üîç main.py ‚Äî Line-by-Line Summary

| Line #  | Purpose                                                          |
| ------- | ---------------------------------------------------------------- |
| 1-7     | Import required libraries                                        |
| 10-12   | Load `.env` and initialize LLM                                   |
| 14-18   | Prompt user for live input                                       |
| 21-38   | Load support policy docs and embed them                          |
| 40-95   | Define graph nodes (classify, retrieve, draft, review, escalate) |
| 98-109  | Define TicketState type                                          |
| 111-122 | Build the LangGraph pipeline and conditional review logic        |
| 125-129 | Run the pipeline and show summary                                |

---

## üßæ Credits

Built with:

* [LangGraph](https://github.com/langchain-ai/langgraph)
* [LangChain](https://www.langchain.com/)
* [Groq](https://groq.com/) for blazing-fast LLM API
* FAISS + HuggingFace for vector search

---

